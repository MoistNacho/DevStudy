# 7ì¥ - ì˜¤ë¥˜ ì²˜ë¦¬
### > ì„œë¡ 
*ê¹¨ë—í•œ ì½”ë“œë¥¼ ë‹¤ë£¨ëŠ” ì±…ì— ì˜¤ë¥˜ ì²˜ë¦¬ë¥¼ ë…¼í•˜ëŠ” ì¥ì´ ìˆì–´ ì´ìƒí•˜ê²Œ ì—¬ê¸¸ì§€ë„ ëª¨ë¥¸ë‹¤.*  ğŸ˜¯

- ê¹¨ë—í•œ ì½”ë“œì™€ ì˜¤ë¥˜ ì²˜ë¦¬ëŠ” í™•ì‹¤íˆ ì—°ê´€ì„±ì´ ìˆê³ , ì˜¤ë¥˜ ì²˜ë¦¬ëŠ” ì¤‘ìš”í•˜ë‹¤
- í•˜ì§€ë§Œ, ì˜¤ë¥˜ ì²˜ë¦¬ ì½”ë“œë¡œ ì¸í•´ í”„ë¡œê·¸ë¨ ë…¼ë¦¬ë¥¼ ì´í•´í•˜ê¸° ì–´ë ¤ì›Œì§„ë‹¤ë©´ ê¹¨ë—í•œ ì½”ë“œë¼ ë¶€ë¥´ê¸° ì–´ë µë‹¤
- ê¹¨ë—í•˜ê³  íŠ¼íŠ¼í•œ ì½”ë“œì— í•œê±¸ìŒ ë” ë‹¤ê°€ê°€ëŠ” ë‹¨ê³„ë¡œ ìš°ì•„í•˜ê³  ê³ ìƒí•˜ê²Œ ì˜¤ë¥˜ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê¸°ë²•ê³¼ ê³ ë ¤ ì‚¬í•­ë“¤ì„ ì•Œì•„ë³´ì

### > ì˜¤ë¥˜ ì½”ë“œë³´ë‹¤ ì˜ˆì™¸ë¥¼ ì‚¬ìš©í•˜ë¼
ì˜ˆì „ì—ëŠ” ì˜ˆì™¸ë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” í”„ë¡œê·¸ë˜ë° ì–¸ì–´ê°€ ë§ì•„ ì˜¤ë¥˜ ì²˜ë¦¬ê°€ ì œí•œì ì´ë‹¤.   
ëª©ë¡7-1 ì˜ˆì œëŠ” ì´ì™€ ê°™ì€ ë°©ë²•ì„ ë³´ì—¬ì£¼ëŠ”ë° ëª‡ê°€ì§€ ë¬¸ì œì ì´ ìˆë‹¤.   

- í˜¸ì¶œí•œ ì¦‰ì‹œ ì˜¤ë¥˜ë¥¼ í™•ì¸í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— í˜¸ì¶œì ì½”ë“œê°€ ë³µì¡ í•´ì§„ë‹¤
- ì˜¤ë¥˜ í™•ì¸ì„ ìŠì–´ë²„ë¦¬ê¸° ì‰½ë‹¤

```
// ëª©ë¡7-1
public class DeviceController {
	...
	public void sendShutDown() {
		DeviceHandle handle = getHandle(DEV1);
		// ë””ë°”ì´ìŠ¤ ìƒíƒœë¥¼ ì ê²€í•œëŒœ.
		if (handle != DeviceHandle.INVALID) {
			// ë ˆì½”ë“œ í•„ë“œì— ë””ë°”ì´ìŠ¤ ìƒíƒœë¥¼ ì €ì¥í•œë‹¤.
			retrieveDeviceRecord(handle);
			// ë””ë°”ì´ìŠ¤ê°€ ì¼ì‹œì •ì§€ ìƒíƒœê°€ ì•„ë‹ˆë¼ë©´ ì¢…ë£Œí•œë‹¤.
			if (record.getStatus() != DEVICE_SUSPENDED) {
				pauseDevice(handle);
				clearDeviceWorkQueue(handle);
				closeDevice(handle);
			} else {
				logger.log("Device suspended. Unable to shut down");
			}
		} else {
			logger.log("Invalid handle for: " + DEV1.toString());
		}
	}
	...
}
```
ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ ì˜ˆì™¸ë¥¼ ë˜ì§€ëŠ” í¸ì´ ë‚«ë‹¤.   
ëª©ë¡ 7-2ëŠ” ì˜¤ë¥˜ë¥¼ ë°œê²¬í•˜ë©´ ì˜ˆì™¸ë¥¼ ë˜ì§€ëŠ” ì½”ë“œì´ë‹¤.

- ë…¼ë¦¬ê°€ ì˜¤ë¥˜ ì²˜ë¦¬ ì½”ë“œì™€ ë’¤ì„ì´ì§€ ì•Šì•„ í˜¸ì¶œì ì½”ë“œê°€ ë” ê¹”ë”í•´ì¡Œë‹¤
```
// ëª©ë¡ 7-2
public class DeviceController {
	...
	public void sendShutDown() {
		try {
			tryToShutDown();
		} catch (DeviceShutDownError e) {
			logger.log(e);
		}
	}

	private void tryToShutDown() throws DeviceShutDownError {
		DeviceHandle handle = getHandle(DEV1);
		DeviceRecord record = retrieveDeviceRecord(handle);
		pauseDevice(handle); 
		clearDeviceWorkQueue(handle); 
		closeDevice(handle);
	}

	private DeviceHandle getHandle(DeviceID id) {
		...
		throw new DeviceShutDownError("Invalid handle for: " + id.toString());
		...
	}
	...
}
```

### > Try-Catch-Finally ë¬¸ë¶€í„° ì‘ì„±í•˜ë¼
try-catch-finally ë¬¸ì—ì„œ try ë¸”ë¡ì— ë“¤ì–´ê°€ëŠ” ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ì–´ëŠ ì‹œì ì—ì„œë“  ì‹¤í–‰ì´ ì¤‘ë‹¨ëœ í›„ catch ë¸”ë¡ìœ¼ë¡œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆë‹¤.   

- try ë¸”ë¡ì—ì„œ ë¬´ìŠ¨ ì¼ì´ ìƒê¸°ë“ ì§€ catch ë¸”ë¡ì€ í”„ë¡œê·¸ë¨ ìƒíƒœë¥¼ ì¼ê´€ì„± ìˆê²Œ ìœ ì§€í•´ì•¼ í•œë‹¤
- try-catch-finally ë¬¸ì„ ì‹œì‘ìœ¼ë¡œ ì½”ë“œë¥¼ ì§œë©´ í˜¸ì¶œìê°€ ê¸°ëŒ€í•˜ëŠ” ìƒíƒœë¥¼ ì •ì˜í•˜ê¸° ì‰¬ì›Œì§„ë‹¤

ë‹¤ìŒì€ íŒŒì¼ì´ ì—†ìœ¼ë©´ ì˜ˆì™¸ë¥¼ ë˜ì§€ëŠ”ì§€ ì•Œì•„ë³´ëŠ” ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì˜ˆì‹œì´ë‹¤.

1.ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“ ë‹¤.
```
 @Test(expected = StorageException.class)
 public void retrieveSectionShouldThrowOnInvalidFileName() {
     sectionStore.retrieveSection("invalid - file");
 }
```

2.ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì— ë§ì¶° ì½”ë“œë¥¼ êµ¬í˜„ í•œë‹¤.
```
 public List<RecordedGrip> retrieveSection(String sectionName) {
     // ì‹¤ì œë¡œ êµ¬í˜„í•  ë•Œê¹Œì§€ ë¹„ì–´ ìˆëŠ” ë”ë¯¸ë¥¼ ë°˜í™˜í•œë‹¤.
     return new ArrayList<RecordedGrip>();
 }
```
- ì˜ˆì™¸ê°€ ë°œìƒí•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì—ì„œ ì‹¤íŒ¨ í•œë‹¤

3.íŒŒì¼ ì ‘ê·¼ì„ ì‹œë„í•˜ë„ë¡ êµ¬í˜„í•œë‹¤.
```
 public List<RecordedGrip> retrieveSection(String sectionName) {
     try {
         FileInputStream stream = new FileInputStream(sectionName);
     } catch (Exception e) {
         throw new StorageException("retrieval error", e);
     }
     return new ArrayList<RecordedGrip>();
 }
```
ì´ì œ í…ŒìŠ¤íŠ¸ì— ì„±ê³µí•  ê²ƒì´ë‹¤.

4.ë¦¬íŒ©í„°ë§ì„ í•œë‹¤.
- catch ë¸”ë¡ì—ì„œ ì˜ˆì™¸ ìœ í˜•ì„ ì¢í˜€ `FileInputStream` ìƒì„±ìê°€ ë˜ì§€ëŠ” `FileNotFoundException`ì„ ì¡ì•„ë‚¸ë‹¤
```
 public List<RecordedGrip> retrieveSection(String sectionName) {
     try {
         FileInputStream stream = new FileInputStream(sectionName);
         stream.close();
     } catch (FileNotFoundException e) {
         throw new StorageException("retrieval error", e);
     }
     return new ArrayList<RecordedGrip>();
 }
```
tray-catch êµ¬ì¡°ë¡œ ë²”ìœ„ë¥¼ ì •ì˜ í–ˆìœ¼ë¯€ë¡œ TDDë¥¼ ì‚¬ìš©í•´ í•„ìš”í•œ ë‚˜ë¨¸ì§€ ë…¼ë¦¬ë¥¼ ì¶”ê°€í•œë‹¤.
- ë¨¼ì € ì˜ˆì™¸ë¥¼ ì¼ìœ¼í‚¤ëŠ” í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì‘ì„± í›„ í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ê²Œ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ë°©ë²•ì„ ê¶Œì¥í•œë‹¤

### > ë¯¸í™•ì¸(unchecked) ì˜ˆì™¸ë¥¼ ì‚¬ìš©í•˜ë¼
`í™•ì¸ëœ(checked) ì˜ˆì™¸`ëŠ” ì»´íŒŒì¼ ë‹¨ê³„ì—ì„œ í™•ì¸ë˜ë©° ë°˜ë“œì‹œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ì˜ˆì™¸   
`ë¯¸í™•ì¸(unchecked) ì˜ˆì™¸`ëŠ” ì‹¤í–‰ ë‹¨ê³„ì—ì„œ í™•ì¸ë˜ë©° ëª…ì‹œì ì¸ ì²˜ë¦¬ë¥¼ ê°•ì œí•˜ì§€ëŠ” ì•ŠëŠ” ì˜ˆì™¸   
- í™•ì¸ëœ ì˜ˆì™¸ëŠ” **OCP**ì›ì¹™ì„ ìœ„ë°˜í•œë‹¤
- ì•„ì£¼ ì¤‘ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‘ì„±í•  ë•Œë¥¼ ì œì™¸í•˜ë©´ í™•ì¸ëœ ì˜ˆì™¸ëŠ” ë¹„ìš©ì†Œëª¨ê°€ ë” í¬ë‹¤

1.ì•„ë˜ ì½”ë“œëŠ” ë‹¨ìˆœí•œ ì¶œë ¥ì„ í•˜ëŠ” ë©”ì†Œë“œì´ë‹¤.
```
 public void printA(bool flag) {
     if(flag){
         System.out.println("called");
     }
 }

 public void func(bool flag) {
     printA(flag);
 }
```
2.í”„ë¦°íŠ¸ë¥¼ ì•ˆí•  ë•Œ `NotPrintException`ì„ ë˜ì§€ê¸°ë¡œ êµ¬í˜„ì„ ë³€ê²½í–ˆì„ ê²½ìš°
```
 public void printA(bool flag) throws NotPrintException {
     if(flag){
         System.out.println("called");
     } else{
         throw new NotPrintException();
     }
 }

 public void func(bool flag) throws NotPrintException {
     printA(flag);
 }
```
í•´ë‹¹ í•¨ìˆ˜ ë¿ë§Œì´ ì•„ë‹ˆë¼ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë„ ìˆ˜ì •ì„ í•´ì¤˜ì•¼í•œë‹¤ ğŸ˜©

### > ì˜ˆì™¸ì— ì˜ë¯¸ë¥¼ ì œê³µí•˜ë¼
ì˜¤ë¥˜ê°€ **ë°œìƒí•œ ì›ì¸ê³¼ ìœ„ì¹˜ë¥¼ ì°¾ê¸° ì‰½ë„ë¡** í˜¸ì¶œ ìŠ¤íƒë§Œìœ¼ë¡œëŠ” ë¶€ì¡±í•œ ì •ë³´ë¥¼ ì¶©ë¶„íˆ ë§ë¶™ì—¬ì•¼ í•œë‹¤
- ì˜¤ë¥˜ ë©”ì‹œì§€ì— ì •ë³´ë¥¼ ë‹´ì•„ ì˜ˆì™¸ë¥¼ ë˜ì§„ë‹¤
- ì‹¤íŒ¨í•œ ì—°ì‚° ì´ë¦„, ì‹¤íŒ¨ ìœ í˜• ì–¸ê¸‰í•œë‹¤

### > í˜¸ì¶œìë¥¼ ê³ ë ¤í•´ ì˜ˆì™¸ í´ë˜ìŠ¤ë¥¼ ì •ì˜í•˜ë¼
*ì˜¤ë¥˜ë¥¼ ì •ì˜í•  ë•Œ í”„ë¡œê·¸ë˜ë¨¸ì—ê²Œ ê°€ì¥ ì¤‘ìš”í•œ ê´€ì‹¬ì‚¬ëŠ” **ì˜¤ë¥˜ë¥¼ ì¡ì•„ë‚´ëŠ” ë°©ë²•**ì´ ë˜ì–´ì•¼ í•œë‹¤.*

1.ì˜¤ë¥˜ë¥¼ í˜•í¸ì—†ì´ ë¶„ë¥˜í•œ ì‚¬ë¡€ ğŸ˜…
```
 ACMEPort port = new ACMEPort(12);

 try {
     port.open();
 } catch (DeviceResponseException e) {
     reportPortError(e);
     logger.log("Device response exception", e);
 } catch (ATM1212UnlockedException e) {
     reportPortError(e);
     logger.log("Unlock exception", e);
 } catch (GMXError e) {
     reportPortError(e);
     logger.log("Device response exception");
 } finally {
     ...
 }
```
- ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í˜¸ì¶œí•˜ê³  ëª¨ë“  ì˜ˆì™¸ë¥¼ í˜¸ì¶œìê°€ ì¡ì•„ë‚´ê³  ìˆë‹¤
- ì˜ˆì™¸ì— ëŒ€ì‘í•˜ëŠ” ë°©ì‹ì´ ì˜ˆì™¸ ìœ í˜•ê³¼ ë¬´ê´€í•˜ê²Œ ê±°ì˜ ë™ì¼í•˜ë‹¤

2.í˜¸ì¶œ ë¼ì´ë¸ŒëŸ¬ë¦¬ APIë¥¼ ê°ì‹¸ í•œê°€ì§€ ì˜ˆì™¸ ìœ í˜•ì„ ë°˜í™˜í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë‹¨ìˆœí™”
```
 LocalPort port = new LocalPort(12);
 try {
     port.open();
 } catch (PortDeviceFailure e) {
     reportError(e);
     logger.log(e.getMessage(), e);
 } finally {
     ...
 }
```
```
 public class LocalPort {
     private ACMEPort innerPort;

     public LocalPort(int portNumber) {
         innerPort = new ACMEPort(portNumber);
     }

     public void open() {
         try {
             innerPort.open();
         } catch (DeviceResponseException e) {
             throw new PortDeviceFailure(e);
         } catch (ATM1212UnlockedException e) {
             throw new PortDeviceFailure(e);
         } catch (GMXError e) {
             throw new PortDeviceFailure(e);
         }
     }
     ...
 }
```
ì™¸ë¶€ APIë¥¼ ê°ì‹¸ë©´ ì•„ë˜ì™€ ê°™ì€ ì¥ì ì´ ìˆë‹¤.

- ì—ëŸ¬ ì²˜ë¦¬ê°€ ê°„ê²°í•´ì§„ë‹¤
- ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ í”„ë¡œê·¸ë¨ ì‚¬ì´ì˜ ì˜ì¡´ì„±ì´ í¬ê²Œ ì¤„ì–´ë“ ë‹¤
- í”„ë¡œê·¸ë¨ í…ŒìŠ¤íŠ¸ê°€ ì‰¬ì›Œì§„ë‹¤
- ì™¸ë¶€ API ì„¤ê³„ ë°©ì‹ì— ì˜ì¡´í•˜ì§€ ì•Šì•„ë„ ëœë‹¤

### > ì •ìƒ íë¦„ì„ ì •ì˜í•˜ë¼
ì• ì ˆì—ì„œ ì¶©ê³ í•œ ì§€ì¹¨ì„ ì¶©ì‹¤íˆ ë”°ë¥¸ë‹¤ë©´ **ë¹„ì¦ˆë‹ˆìŠ¤ ë…¼ë¦¬**ì™€ **ì˜¤ë¥˜ ì²˜ë¦¬**ê°€ ì˜ ë¶„ë¦¬ëœ ì½”ë“œê°€ ë‚˜ì˜¨ë‹¤.ğŸ˜   
í•˜ì§€ë§Œ, ë•Œë¡œëŠ” ì¤‘ë‹¨ì´ ì í•©í•˜ì§€ ì•Šì€ ë•Œë„ ìˆë‹¤.

1.ë¹„ìš© ì²­êµ¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì´ê³„ë¥¼ ê³„ì‚°í•˜ëŠ” í—ˆìˆ í•œ ì½”ë“œ (íŠ¹ìˆ˜ ì‚¬ë¡€)
```
 try {
     MealExpenses expenses = expenseReportDAO.getMeals(employee.getID());
     m_total += expenses.getTotal();
 } catch(MealExpencesNotFound e) {
     m_total += getMealPerDiem();
 }
```
ìœ„ì™€ ê°™ì´ ë©”ì„œë“œì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ì§€ ì•Šì•˜ë‹¤ë©´ ë°˜í™˜ëœ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ `getTotal()`ì„ í˜¸ì¶œí•˜ì—¬ ë” í•˜ê³ ,   
ë§Œì•½ `MealExpensesNotFound` ì˜ˆì™¸ê°€ ë°œìƒí•œë‹¤ë©´ `getMealPerDien()`  ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•´ ë°˜í™˜ëœ ê°’ì„ ë”í•´ì¤€ë‹¤.  
- ì˜ˆì™¸ê°€ ë…¼ë¦¬ë¥¼ ë”°ë¼ê°€ê¸° ì–´ë µê²Œ ë§Œë“ ë‹¤

2.íŠ¹ìˆ˜í•œ ì˜ˆì™¸ìƒí™© ìì²´ê°€ ì•ˆë‚˜ë„ë¡ ë§Œë“¤ì–´ì£¼ë©´ ì½”ë“œê°€ ë” ê°„ê²°í•´ì§„ë‹¤.
```
public class PerDiemMealExpenses implements MealExpenses {
	public int getTotal(){
		//ê¸°ë³¸ê°’ìœ¼ë¡œ ì¼ì¼ ê¸°ë³¸ ì‹ë¹„ë¥¼ ë°˜í™˜í•œë‹¤.
	}
}
```
```
 MealExpenses expenses = expenseReportDAO.getMeals(employee.getID());
 m_total += expenses.getTotal();
```
ì²­êµ¬í•œ ì‹ë¹„ê°€ ì—†ë‹¤ë©´ ì¼ì¼ ê¸°ë³¸ì‹ë¹„ë¥¼ ë°˜í™˜í•˜ëŠ” ê°ì²´ë¥¼ ë°˜í™˜í•˜ê²Œ í•œë‹¤ë©´ ì˜ˆì™¸ì ì¸ ìƒí™©ì„ ì²˜ë¦¬í•  í•„ìš”ê°€ ì—†ì–´ì§„ë‹¤.   
í´ë˜ìŠ¤ë‚˜ ê°ì²´ê°€ ì˜ˆì™¸ì ì¸ ìƒí™©ì„ ìº¡ìŠí™”í•´ì„œ ì²˜ë¦¬í•˜ë¯€ë¡œ.
